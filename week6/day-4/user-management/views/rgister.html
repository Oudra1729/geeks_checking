<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Register</title>
      <style>
         .wrapper {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
         }

         .registration_form {
            display: flex;
            flex-direction: column;
            gap: 5px;
            width: 300px;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
         }

         label {
            font-weight: bold;
            margin-top: 10px;
         }

         .message {
            margin-top: 15px;
            color: red;
            font-weight: bold;
         }
      </style>
   </head>
   <body>
      <div class="wrapper">
         <form action="/register" class="registration_form">
            <h2>Register:</h2>
            <label for="firstname">First Name</label>
            <input
               type="text"
               id="firstname"
               name="firstname"
               placeholder="First Name"
            />
            <label for="lastname">Last Name</label>
            <input
               type="text"
               id="lastname"
               name="lastname"
               placeholder="Last Name"
            />
            <label for="email">Email</label>
            <input type="email" id="email" name="email" placeholder="Email" />
            <label for="username">Username</label>
            <input
               type="text"
               id="username"
               name="username"
               placeholder="Username"
            />
            <label for="password">Password</label>
            <input
               type="password"
               id="password"
               name="password"
               placeholder="Password"
            />
            <button type="submit">Register</button>
         </form>
         <div class="message"></div>
      </div>
      <script>
         const submitButton = document.querySelector('button[type="submit"]');
         const messageDiv = document.querySelector(".message");
         const form = document.querySelector("form");

         form.addEventListener("submit", async (event) => {
            event.preventDefault();
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            const fetchedData = await fetch(
               "http://localhost:3000/users/register",
               {
                  method: "POST",
                  headers: {
                     "Content-Type": "application/json",
                  },
                  body: JSON.stringify(data),
               }
            );

            const result = await fetchedData.json();
            if (fetchedData.ok) {
               messageDiv.textContent = "Registration successful!";
               messageDiv.style.color = "green";
               form.reset();
            } else {
               messageDiv.textContent =
                  result.message || "Registration failed.";
               messageDiv.style.color = "red";
            }

            console.log(result);
         });
      </script>
   </body>
</html>
